{% extends 'base.html.twig' %}

{% block title %}Carte Interractive!{% endblock %}

{% block main %}

<div id="maCarte" data-station="{{ station|json_encode }}"></div>

  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
    integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="crossorigin=""></script>

  <script type="text/javascript">
      console.log(document.getElementById('maCarte').dataset.dataStation);
      carte = L.map('maCarte').setView([43.62505, 3.862038], 12);
      L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
        attribution: 'données © <a href="//osm.org/copyright">OpenStreetMap</a>/ODbL - rendu <a href="//openstreetmap.fr">OSM France</a>',
        minZoom: 1,
        maxZoom: 20
      }).addTo(carte);

        let stationsNodeList = document.querySelectorAll('div.stations > div');
        let stationDivs = Array.from(stationsNodeList);
        stationDivs.shift();

    function createMarkers(divs, name, array) {
        for (i = 0; i < divs.length; i++) {
            window[name + i] = L.marker([divs[i].dataset.localisation]).addTo(carte)
      .bindPopup(`<div class="card" style="width: 18rem;"> <div class="card-body"> <h5 class="card-subtitle mb-2">Titre</h5> <p class="card-text">Courte Description.</p> <a href="#" class="card-link">Lien Vers L'adresse</a> <a href="#" class="card-link">Lien vers l'oéprateur©</a>`)
      .openPopup();
  </script>
{% endblock %}
